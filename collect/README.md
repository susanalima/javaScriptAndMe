## SETUP


1. Install [docker](https://docs.docker.com/get-docker/).


3. Give permissions to scripts.

    In collect folder:

    `cd scripts`

    `chmod +x init.sh`

    `chmod +x clean.sh`

    In github, npm and web folders:

    `chmod +x build.sh`

    `chmod +x run.h`

4. Run init script to create required directory structure (`sudo` required).

    `./scripts/init.sh`
  
## BUILD and RUN

### GITHUB

`cd ./github`

build: 

`./build.sh` 

run: 

`./run.sh <collect_option> <number_repos> <source> <start_at>`

* collect_option (default = code): 
    * "code": for collecting the javascript from the websites
    * "sources": for collecting urls from GitHub's REST API
* number_repos (default = 1000): number of repositories to clone 
* source (default = extensions):
    * "extensions": collect list of browser extensions
    * "vanilla": collect list of repositories written in vanilla javascript
    * "server": collect list of repositories wich contain server side code
* start_at (default = 1): position of the repositories list (./input/) to start cloning the repositories (only valid when collect_option = code)



If collect_option is sources then the output is stored in the collect/input directory (as it will be used as input for collecting the sources)
If collect_option is code then the output is stored in the collect/output directory and the logs are stored in the logs/output directory.




### NPM

Go [here](https://gist.github.com/anvaka/8e8fa57c7ee1350e3491#file-01-most-dependent-upon-md) and copy the raw version of the file to npmsToDownloadRaw.md (./input/)

`cd ./npm`

build: 

`./build.sh`

run: 

`./run.sh <collect_option> <number_modules> <start_at>`

* collect_option (default == code): 
    * "code": for collecting the code from the modules
    * "sources": for collecting urls from [here](https://gist.github.com/anvaka/8e8fa57c7ee1350e3491#file-01-most-dependent-upon-md). 
* number_modules (default = 1000): number of modules to download 
* start_at (default = 1): position of the npmsToDownloadRaw.md list (./input/) to start downloading the packages (only valid when collect_option = code)


If collect_option is sources then the output is stored in the collect/input directory (as it will be used as input for collecting the sources)
If collect_option is code then the output is stored in the collect/output directory and the logs are stored in the logs/output directory.



### WEB

`cd ./web`

build: 
`./build.sh`

run: 

`./run.sh <collect_option> <number_urls> <start_at>`

* collect_option (default = code):
    * "code": for collecting the javascript from the websites
    * "sources": for collecting urls from the [Majestic Million service](https://de.majestic.com/reports/majestic-million?)
* number_urls (default: 10000): number of sites to visit / collect
* start_at (default = 1):
    * if collection_option is "code": position of the urlsToVisit.txt list (./input/) to start visiting the urls
    * if collection_option is "sources": position of [Majestic Million service](https://de.majestic.com/reports/majestic-million?) list (./input/) to start retrieving urls

If collect_option is sources then the output is stored in the collect/input directory (as it will be used as input for collecting the sources)
If collect_option is code then the output is stored in the collect/output directory and the logs are stored in the logs/output directory.


Note: if something fails while retrieving javascript from the web the log whill say that the operation failed even if some files where collected successfully


## Scripts


init input, output and logs: `./scripts/init.sh`

clean input, output and logs: `./scripts/clean.sh`



## PROJECT STRUCTURE

```src
├── collect
│   ├── github
│   ├── globals
│   ├── input
│   ├── logs
│   │   ├── github
│   │   ├── npm
│   │   ├── web
│   ├── npm
│   ├── output
│   │   ├── github
│   │   ├── npm
│   │   ├── web
│   ├── scripts
│   ├── web
```

_github_ - Responsible for collecting a list of repositories and to clone them. The list is collected with Github's REST API.

_globals_ - This folder contains a file with the global variales used in the project.

_input_ - This folder houses the input files for the program.

_logs_ - This folder houses the log files of the program.

- _github_ - Logs generated by the github component of the program.

- _npm_ - Logs generated by the npm component of the program.

- _web_ - Logs generated by the web component of the program.


_output_: This folder houses the output files of the program.

- _github_: Al the repositories collected from github.

- _npm_: All the modules collected from npm.

- _web_: ALl javascript code collected from the web (separeted in folders per website).

_npm_ - Responsible for downloading npm modules from [here](https://gist.github.com/anvaka/8e8fa57c7ee1350e3491#file-01-most-dependent-upon-md).

_scripts_ - Contains scripts to create and clean all the required logs, output and input folders.

_web_ - Responsible for collecting javascript from different websites. The list of websites is collected from  the [Majestic Million service](https://de.majestic.com/reports/majestic-million?)
